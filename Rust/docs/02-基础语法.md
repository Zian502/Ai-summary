# åŸºç¡€è¯­æ³•

## å˜é‡å’Œå¯å˜æ€§

### å˜é‡å£°æ˜

Rust ä½¿ç”¨ `let` å…³é”®å­—å£°æ˜å˜é‡ï¼Œé»˜è®¤å˜é‡æ˜¯**ä¸å¯å˜çš„**ï¼ˆimmutableï¼‰ã€‚

```rust
fn main() {
    // ä¸å¯å˜å˜é‡ï¼ˆé»˜è®¤ï¼‰
    let x = 5;
    // x = 6;  // é”™è¯¯ï¼ä¸èƒ½ä¿®æ”¹ä¸å¯å˜å˜é‡
    
    // å¯å˜å˜é‡ï¼ˆä½¿ç”¨ mut å…³é”®å­—ï¼‰
    let mut y = 5;
    y = 6;  // æ­£ç¡®ï¼å¯ä»¥ä¿®æ”¹
    
    // ç±»å‹æ³¨è§£ï¼ˆå¯é€‰ï¼Œç¼–è¯‘å™¨å¯ä»¥æ¨æ–­ï¼‰
    let z: i32 = 5;
    let mut w: i32 = 10;
}
```

### å˜é‡é®è”½ï¼ˆShadowingï¼‰

Rust å…è®¸ä½¿ç”¨ç›¸åŒçš„åå­—é‡æ–°å£°æ˜å˜é‡ï¼Œè¿™å«åš"é®è”½"ï¼š

```rust
fn main() {
    let x = 5;
    let x = x + 1;  // é®è”½ï¼Œåˆ›å»ºæ–°å˜é‡
    {
        let x = x * 2;  // åœ¨ä½œç”¨åŸŸå†…é®è”½
        println!("å†…éƒ¨ x: {}", x);  // è¾“å‡ºï¼šå†…éƒ¨ x: 12
    }
    println!("å¤–éƒ¨ x: {}", x);  // è¾“å‡ºï¼šå¤–éƒ¨ x: 6
    
    // å¯ä»¥æ”¹å˜ç±»å‹
    let spaces = "   ";
    let spaces = spaces.len();  // ä» &str å˜ä¸º usize
    println!("spaces: {}", spaces);  // è¾“å‡ºï¼šspaces: 3
}
```

### ä¸å…¶ä»–è¯­è¨€å¯¹æ¯”

| è¯­è¨€ | å˜é‡å£°æ˜ | å¯å˜æ€§ | ç±»å‹æ¨æ–­ |
|------|---------|--------|---------|
| **Rust** | `let x = 5;` | é»˜è®¤ä¸å¯å˜ï¼Œéœ€ `mut` | âœ… æ”¯æŒ |
| **C++** | `int x = 5;` | é»˜è®¤å¯å˜ï¼Œ`const` ä¸å¯å˜ | âœ… æ”¯æŒï¼ˆC++11+ï¼‰ |
| **Go** | `x := 5` | é»˜è®¤å¯å˜ | âœ… æ”¯æŒ |
| **Java** | `int x = 5;` | é»˜è®¤å¯å˜ï¼Œ`final` ä¸å¯å˜ | âœ… æ”¯æŒï¼ˆJava 10+ï¼‰ |
| **Python** | `x = 5` | é»˜è®¤å¯å˜ | âœ… æ”¯æŒ |

**Rust ç‰¹ç‚¹**ï¼š
- é»˜è®¤ä¸å¯å˜ï¼Œæé«˜å®‰å…¨æ€§
- ä½¿ç”¨ `mut` æ˜ç¡®è¡¨ç¤ºå¯å˜æ€§
- å˜é‡é®è”½å…è®¸é‡æ–°ç»‘å®šï¼ˆç”šè‡³æ”¹å˜ç±»å‹ï¼‰

## å¸¸é‡

å¸¸é‡ä½¿ç”¨ `const` å…³é”®å­—å£°æ˜ï¼Œå¿…é¡»æ ‡æ³¨ç±»å‹ï¼Œä¸”åªèƒ½è®¾ç½®ä¸ºå¸¸é‡è¡¨è¾¾å¼ï¼š

```rust
// å¸¸é‡å‘½åçº¦å®šï¼šå…¨å¤§å†™ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿
const MAX_POINTS: u32 = 100_000;
const PI: f64 = 3.14159;

fn main() {
    println!("æœ€å¤§ç‚¹æ•°: {}", MAX_POINTS);
    println!("åœ†å‘¨ç‡: {}", PI);
    
    // å¸¸é‡å¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸå£°æ˜
    const LOCAL_CONST: i32 = 42;
    println!("å±€éƒ¨å¸¸é‡: {}", LOCAL_CONST);
}
```

### å¸¸é‡ vs ä¸å¯å˜å˜é‡

| ç‰¹æ€§ | å¸¸é‡ (`const`) | ä¸å¯å˜å˜é‡ (`let`) |
|------|---------------|-------------------|
| ç±»å‹æ³¨è§£ | å¿…é¡» | å¯é€‰ |
| å€¼ | å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ | å¯ä»¥æ˜¯è¿è¡Œæ—¶è®¡ç®—çš„å€¼ |
| ä½œç”¨åŸŸ | å¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸ | éµå¾ªä½œç”¨åŸŸè§„åˆ™ |
| é®è”½ | ä¸å…è®¸ | å…è®¸ |

```rust
fn main() {
    // å¸¸é‡
    const MAX: u32 = 100;
    
    // ä¸å¯å˜å˜é‡
    let x = 5;
    let y = x * 2;  // è¿è¡Œæ—¶è®¡ç®—ï¼Œä¸èƒ½ç”¨ const
    
    // é®è”½ç¤ºä¾‹
    let name = "Rust";
    let name = name.len();  // é®è”½ï¼Œæ”¹å˜ç±»å‹
    // const NAME: usize = name.len();  // é”™è¯¯ï¼ä¸èƒ½æ˜¯è¿è¡Œæ—¶å€¼
}
```

## æ•°æ®ç±»å‹

Rust æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚

### æ ‡é‡ç±»å‹ï¼ˆScalar Typesï¼‰

#### æ•´æ•°ç±»å‹

```rust
fn main() {
    // æœ‰ç¬¦å·æ•´æ•°
    let a: i8 = 127;      // 8 ä½ï¼Œ-128 åˆ° 127
    let b: i16 = 32767;   // 16 ä½
    let c: i32 = 2147483647;  // 32 ä½ï¼ˆé»˜è®¤ï¼‰
    let d: i64 = 9223372036854775807;  // 64 ä½
    let e: i128 = 170141183460469231731687303715884105727;  // 128 ä½
    let f: isize = 100;   // æ¶æ„ç›¸å…³ï¼ˆ32/64 ä½ï¼‰
    
    // æ— ç¬¦å·æ•´æ•°
    let u: u8 = 255;      // 8 ä½ï¼Œ0 åˆ° 255
    let v: u16 = 65535;   // 16 ä½
    let w: u32 = 4294967295;  // 32 ä½
    let x: u64 = 18446744073709551615;  // 64 ä½
    let y: u128 = 340282366920938463463374607431768211455;  // 128 ä½
    let z: usize = 100;   // æ¶æ„ç›¸å…³ï¼ˆ32/64 ä½ï¼‰
    
    // å­—é¢é‡
    let decimal = 98_222;        // åè¿›åˆ¶ï¼š98222
    let hex = 0xff;              // åå…­è¿›åˆ¶ï¼š255
    let octal = 0o77;            // å…«è¿›åˆ¶ï¼š63
    let binary = 0b1111_0000;    // äºŒè¿›åˆ¶ï¼š240
    let byte = b'A';             // å­—èŠ‚ï¼ˆä»… u8ï¼‰ï¼š65
}
```

#### æµ®ç‚¹ç±»å‹

```rust
fn main() {
    // f32ï¼šå•ç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ32 ä½ï¼‰
    let x: f32 = 3.14;
    
    // f64ï¼šåŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ64 ä½ï¼Œé»˜è®¤ï¼‰
    let y = 3.14;  // é»˜è®¤ f64
    let z: f64 = 2.71828;
    
    // ç§‘å­¦è®¡æ•°æ³•
    let scientific = 1.0e6;  // 1000000.0
}
```

#### å¸ƒå°”ç±»å‹

```rust
fn main() {
    let t = true;
    let f: bool = false;
    
    // å¸ƒå°”å€¼ç”¨äºæ¡ä»¶è¡¨è¾¾å¼
    if t {
        println!("è¿™æ˜¯çœŸçš„");
    }
}
```

#### å­—ç¬¦ç±»å‹

```rust
fn main() {
    // charï¼š4 å­—èŠ‚ Unicode æ ‡é‡å€¼
    let c = 'z';
    let z = 'â„¤';
    let heart = 'â¤';
    let emoji = 'ğŸ˜€';
    
    // æ³¨æ„ï¼šchar æ˜¯å•å¼•å·ï¼Œå­—ç¬¦ä¸²æ˜¯åŒå¼•å·
    let string = "è¿™æ˜¯å­—ç¬¦ä¸²";  // &str ç±»å‹
}
```

### å¤åˆç±»å‹ï¼ˆCompound Typesï¼‰

#### å…ƒç»„ï¼ˆTupleï¼‰

```rust
fn main() {
    // åˆ›å»ºå…ƒç»„
    let tup: (i32, f64, u8) = (500, 6.4, 1);
    
    // è§£æ„å…ƒç»„
    let (x, y, z) = tup;
    println!("x: {}, y: {}, z: {}", x, y, z);
    
    // é€šè¿‡ç´¢å¼•è®¿é—®
    println!("ç¬¬ä¸€ä¸ªå…ƒç´ : {}", tup.0);
    println!("ç¬¬äºŒä¸ªå…ƒç´ : {}", tup.1);
    println!("ç¬¬ä¸‰ä¸ªå…ƒç´ : {}", tup.2);
    
    // ç©ºå…ƒç»„ï¼ˆå•å…ƒç±»å‹ï¼‰
    let unit = ();
}
```

#### æ•°ç»„ï¼ˆArrayï¼‰

```rust
fn main() {
    // æ•°ç»„ï¼šå›ºå®šé•¿åº¦ï¼Œç›¸åŒç±»å‹
    let a = [1, 2, 3, 4, 5];
    let months = ["January", "February", "March", "April", "May",
                  "June", "July", "August", "September", "October",
                  "November", "December"];
    
    // ç±»å‹æ³¨è§£
    let a: [i32; 5] = [1, 2, 3, 4, 5];
    
    // åˆå§‹åŒ–ç›¸åŒå€¼
    let a = [3; 5];  // [3, 3, 3, 3, 3]
    
    // è®¿é—®å…ƒç´ 
    let first = a[0];
    let second = a[1];
    
    // æ•°ç»„è¶Šç•Œä¼šåœ¨è¿è¡Œæ—¶ panic
    // let invalid = a[10];  // è¿è¡Œæ—¶é”™è¯¯ï¼
}
```

### ä¸å…¶ä»–è¯­è¨€å¯¹æ¯”

| è¯­è¨€ | æ•´æ•°é»˜è®¤ç±»å‹ | æµ®ç‚¹é»˜è®¤ç±»å‹ | æ•°ç»„ç±»å‹ |
|------|------------|------------|---------|
| **Rust** | `i32` | `f64` | å›ºå®šé•¿åº¦ `[T; N]` |
| **C++** | `int`ï¼ˆå¹³å°ç›¸å…³ï¼‰ | `double` | å›ºå®šé•¿åº¦æˆ–åŠ¨æ€ |
| **Go** | `int`ï¼ˆå¹³å°ç›¸å…³ï¼‰ | `float64` | åˆ‡ç‰‡ `[]T` |
| **Java** | `int` | `double` | æ•°ç»„æˆ– `ArrayList` |
| **Python** | ä»»æ„ç²¾åº¦ | `float` | åˆ—è¡¨ï¼ˆåŠ¨æ€ï¼‰ |

## å‡½æ•°

### å‡½æ•°å®šä¹‰

```rust
// å‡½æ•°å®šä¹‰ä½¿ç”¨ fn å…³é”®å­—
fn main() {
    println!("Hello from main!");
    another_function();
    
    // è°ƒç”¨å¸¦å‚æ•°çš„å‡½æ•°
    print_labeled_measurement(5, 'h');
    
    // è°ƒç”¨æœ‰è¿”å›å€¼çš„å‡½æ•°
    let x = five();
    println!("five() è¿”å›å€¼: {}", x);
    
    let y = plus_one(5);
    println!("plus_one(5) è¿”å›å€¼: {}", y);
}

// æ— å‚æ•°å‡½æ•°
fn another_function() {
    println!("Hello from another function!");
}

// å¸¦å‚æ•°å‡½æ•°
fn print_labeled_measurement(value: i32, unit_label: char) {
    println!("æµ‹é‡å€¼: {}{}", value, unit_label);
}

// æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼ˆä½¿ç”¨ -> æŒ‡å®šè¿”å›ç±»å‹ï¼‰
fn five() -> i32 {
    5  // æ³¨æ„ï¼šæ²¡æœ‰åˆ†å·ï¼Œè¿™æ˜¯è¡¨è¾¾å¼ï¼Œä¸æ˜¯è¯­å¥
}

fn plus_one(x: i32) -> i32 {
    x + 1  // è¡¨è¾¾å¼ä½œä¸ºè¿”å›å€¼
    // å¦‚æœåŠ ä¸Šåˆ†å·ï¼Œå°±å˜æˆè¯­å¥ï¼Œè¿”å› () ç±»å‹
    // x + 1;  // é”™è¯¯ï¼
}
```

### è¯­å¥å’Œè¡¨è¾¾å¼

```rust
fn main() {
    // è¯­å¥ï¼ˆStatementï¼‰ï¼šæ‰§è¡Œæ“ä½œä½†ä¸è¿”å›å€¼
    let x = 6;  // è¿™æ˜¯ä¸€ä¸ªè¯­å¥
    
    // è¡¨è¾¾å¼ï¼ˆExpressionï¼‰ï¼šè®¡ç®—å¹¶è¿”å›å€¼
    let y = {
        let x = 3;
        x + 1  // è¿™æ˜¯è¡¨è¾¾å¼ï¼Œæ²¡æœ‰åˆ†å·
    };
    println!("y: {}", y);  // è¾“å‡ºï¼šy: 4
    
    // å‡½æ•°è°ƒç”¨æ˜¯è¡¨è¾¾å¼
    let z = five();
    
    // å®è°ƒç”¨æ˜¯è¡¨è¾¾å¼
    let w = println!("Hello");  // è¿”å› () ç±»å‹
}
```

### ä¸å…¶ä»–è¯­è¨€å¯¹æ¯”

| è¯­è¨€ | å‡½æ•°å®šä¹‰ | è¿”å›å€¼ | æœ€åè¡¨è¾¾å¼ |
|------|---------|--------|-----------|
| **Rust** | `fn name() -> Type` | æ˜¾å¼ `->` | æœ€åè¡¨è¾¾å¼è‡ªåŠ¨è¿”å› |
| **C++** | `Type name()` | æ˜¾å¼ `return` | éœ€è¦ `return` |
| **Go** | `func name() Type` | æ˜¾å¼ `return` | éœ€è¦ `return` |
| **Java** | `Type name()` | æ˜¾å¼ `return` | éœ€è¦ `return` |
| **Python** | `def name():` | æ˜¾å¼ `return` | éœ€è¦ `return` |

**Rust ç‰¹ç‚¹**ï¼š
- æœ€åè¡¨è¾¾å¼è‡ªåŠ¨ä½œä¸ºè¿”å›å€¼ï¼ˆæ— åˆ†å·ï¼‰
- æ˜¾å¼è¿”å›ç±»å‹æ³¨è§£
- å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘

## æ³¨é‡Š

```rust
fn main() {
    // è¿™æ˜¯å•è¡Œæ³¨é‡Š
    
    // ä¹Ÿå¯ä»¥è¿™æ ·å†™å¤šè¡Œæ³¨é‡Š
    // æ¯è¡Œéƒ½ç”¨ //
    
    /*
     * è¿™æ˜¯å—æ³¨é‡Š
     * å¯ä»¥è·¨å¤šè¡Œ
     */
    
    let x = 5;  // è¡Œå°¾æ³¨é‡Š
    
    // æ–‡æ¡£æ³¨é‡Šï¼ˆç”¨äºç”Ÿæˆæ–‡æ¡£ï¼‰
    /// è¿™æ˜¯å‡½æ•°æ–‡æ¡£æ³¨é‡Š
    /// 
    /// # ç¤ºä¾‹
    /// ```
    /// let result = add(2, 3);
    /// assert_eq!(result, 5);
    /// ```
    fn add(a: i32, b: i32) -> i32 {
        a + b
    }
    
    // æ¨¡å—çº§æ–‡æ¡£æ³¨é‡Š
    //! è¿™æ˜¯æ¨¡å—çº§æ–‡æ¡£æ³¨é‡Š
    //! ç”¨äºæè¿°æ•´ä¸ªæ¨¡å—
}
```

## å‘½åè§„èŒƒ

Rust éµå¾ªä»¥ä¸‹å‘½åçº¦å®šï¼š

```rust
// å˜é‡å’Œå‡½æ•°ï¼šsnake_case
let my_variable = 10;
fn my_function() {}

// ç±»å‹ï¼ˆç»“æ„ä½“ã€æšä¸¾ã€traitï¼‰ï¼šPascalCase
struct MyStruct {}
enum MyEnum {}
trait MyTrait {}

// å¸¸é‡ï¼šSCREAMING_SNAKE_CASE
const MAX_POINTS: u32 = 100_000;

// æ¨¡å—ï¼šsnake_case
mod my_module {}

// ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼šå•å¼•å· + å°å†™å­—æ¯
fn foo<'a>(x: &'a str) -> &'a str {
    x
}
```

## ä½œç”¨åŸŸå’Œå˜é‡ç”Ÿå‘½å‘¨æœŸ

```rust
fn main() {
    let x = 5;  // x è¿›å…¥ä½œç”¨åŸŸ
    
    {
        let y = 10;  // y è¿›å…¥ä½œç”¨åŸŸ
        println!("x: {}, y: {}", x, y);
    }  // y ç¦»å¼€ä½œç”¨åŸŸï¼Œè¢«é”€æ¯
    
    // println!("y: {}", y);  // é”™è¯¯ï¼y ä¸åœ¨ä½œç”¨åŸŸä¸­
    println!("x: {}", x);  // x ä»ç„¶æœ‰æ•ˆ
}  // x ç¦»å¼€ä½œç”¨åŸŸï¼Œè¢«é”€æ¯
```

## ç±»å‹è½¬æ¢

```rust
fn main() {
    // æ˜¾å¼ç±»å‹è½¬æ¢
    let x: i32 = 5;
    let y: f64 = x as f64;
    
    // å­—ç¬¦ä¸²è½¬æ•°å­—
    let string_number = "42";
    let number: i32 = string_number.parse().unwrap();
    // æˆ–ä½¿ç”¨ç±»å‹æ¨æ–­
    let number: i32 = string_number.parse().expect("ä¸æ˜¯æ•°å­—");
    
    // æ•°å­—è½¬å­—ç¬¦ä¸²
    let num = 42;
    let string = num.to_string();
    let formatted = format!("æ•°å­—: {}", num);
}
```

## å®è·µç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæ¸©åº¦è½¬æ¢

```rust
fn main() {
    let celsius = 25.0;
    let fahrenheit = celsius_to_fahrenheit(celsius);
    println!("{}Â°C = {}Â°F", celsius, fahrenheit);
    
    let fahrenheit = 77.0;
    let celsius = fahrenheit_to_celsius(fahrenheit);
    println!("{}Â°F = {}Â°C", fahrenheit, celsius);
}

fn celsius_to_fahrenheit(c: f64) -> f64 {
    c * 9.0 / 5.0 + 32.0
}

fn fahrenheit_to_celsius(f: f64) -> f64 {
    (f - 32.0) * 5.0 / 9.0
}
```

### ç¤ºä¾‹ 2ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—

```rust
fn main() {
    let n = 10;
    for i in 0..n {
        println!("F({}) = {}", i, fibonacci(i));
    }
}

fn fibonacci(n: u32) -> u32 {
    if n <= 1 {
        n
    } else {
        fibonacci(n - 1) + fibonacci(n - 2)
    }
}
```

## æ€»ç»“

- **å˜é‡**ï¼šä½¿ç”¨ `let` å£°æ˜ï¼Œé»˜è®¤ä¸å¯å˜ï¼Œéœ€è¦ `mut` æ‰èƒ½ä¿®æ”¹
- **å¸¸é‡**ï¼šä½¿ç”¨ `const` å£°æ˜ï¼Œå¿…é¡»æ ‡æ³¨ç±»å‹
- **æ•°æ®ç±»å‹**ï¼šæ ‡é‡ç±»å‹ï¼ˆæ•´æ•°ã€æµ®ç‚¹ã€å¸ƒå°”ã€å­—ç¬¦ï¼‰å’Œå¤åˆç±»å‹ï¼ˆå…ƒç»„ã€æ•°ç»„ï¼‰
- **å‡½æ•°**ï¼šä½¿ç”¨ `fn` å®šä¹‰ï¼Œæœ€åè¡¨è¾¾å¼è‡ªåŠ¨è¿”å›
- **æ³¨é‡Š**ï¼šå•è¡Œ `//`ï¼Œå—æ³¨é‡Š `/* */`ï¼Œæ–‡æ¡£æ³¨é‡Š `///` å’Œ `//!`
- **å‘½å**ï¼šéµå¾ª Rust å‘½åçº¦å®šï¼ˆsnake_caseã€PascalCase ç­‰ï¼‰

ç»§ç»­å­¦ä¹ ï¼š[æ•°æ®ç±»å‹](./03-æ•°æ®ç±»å‹.md) æ·±å…¥äº†è§£ Rust çš„ç±»å‹ç³»ç»Ÿï¼

