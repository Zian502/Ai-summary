# æ•°æ®ç±»å‹

Rust æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚Rust çš„ç±»å‹ç³»ç»ŸåŒ…æ‹¬æ ‡é‡ç±»å‹å’Œå¤åˆç±»å‹ã€‚

## æ ‡é‡ç±»å‹ï¼ˆScalar Typesï¼‰

æ ‡é‡ç±»å‹è¡¨ç¤ºå•ä¸ªå€¼ï¼ŒRust æœ‰å››ç§ä¸»è¦çš„æ ‡é‡ç±»å‹ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼å’Œå­—ç¬¦ã€‚

### æ•´æ•°ç±»å‹

æ•´æ•°æ˜¯æ²¡æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å­—ã€‚

| é•¿åº¦ | æœ‰ç¬¦å· | æ— ç¬¦å· |
|------|--------|--------|
| 8-bit | `i8` | `u8` |
| 16-bit | `i16` | `u16` |
| 32-bit | `i32` | `u32` |
| 64-bit | `i64` | `u64` |
| 128-bit | `i128` | `u128` |
| arch | `isize` | `usize` |

```rust
fn main() {
    // æœ‰ç¬¦å·æ•´æ•°ï¼ˆå¯ä»¥è¡¨ç¤ºè´Ÿæ•°ï¼‰
    let a: i8 = -128;
    let b: i32 = -2147483648;
    let c: i64 = 9223372036854775807;
    
    // æ— ç¬¦å·æ•´æ•°ï¼ˆåªèƒ½è¡¨ç¤ºéè´Ÿæ•°ï¼‰
    let d: u8 = 255;
    let e: u32 = 4294967295;
    let f: u64 = 18446744073709551615;
    
    // isize å’Œ usize å–å†³äºæ¶æ„ï¼ˆ32ä½æˆ–64ä½ï¼‰
    let g: isize = -100;
    let h: usize = 100;
    
    // æ•´æ•°å­—é¢é‡
    let decimal = 98_222;           // åè¿›åˆ¶ï¼š98222
    let hex = 0xff;                 // åå…­è¿›åˆ¶ï¼š255
    let octal = 0o77;               // å…«è¿›åˆ¶ï¼š63
    let binary = 0b1111_0000;       // äºŒè¿›åˆ¶ï¼š240
    let byte = b'A';                // å­—èŠ‚ï¼ˆä»… u8ï¼‰ï¼š65
    
    // ç±»å‹æ¨æ–­
    let x = 42;  // é»˜è®¤æ¨æ–­ä¸º i32
    let y: u64 = 42;  // æ˜¾å¼æŒ‡å®šç±»å‹
}
```

### æ•´æ•°æº¢å‡º

```rust
fn main() {
    // åœ¨ debug æ¨¡å¼ä¸‹ï¼Œæ•´æ•°æº¢å‡ºä¼š panic
    // åœ¨ release æ¨¡å¼ä¸‹ï¼Œä¼šè¿›è¡Œç¯ç»•ï¼ˆwrappingï¼‰
    
    let mut x: u8 = 255;
    // x = x + 1;  // debug æ¨¡å¼ï¼španic!
    
    // ä½¿ç”¨ wrapping æ–¹æ³•æ˜¾å¼ç¯ç»•
    let y = x.wrapping_add(1);  // 0
    println!("wrapping_add: {}", y);
    
    // ä½¿ç”¨ checked æ–¹æ³•æ£€æŸ¥æº¢å‡º
    match x.checked_add(1) {
        Some(result) => println!("ç»“æœ: {}", result),
        None => println!("æº¢å‡ºï¼"),
    }
    
    // ä½¿ç”¨ saturating æ–¹æ³•é¥±å’Œè¿ç®—
    let z = x.saturating_add(1);  // 255ï¼ˆä¸ä¼šæº¢å‡ºï¼‰
    println!("saturating_add: {}", z);
}
```

### æµ®ç‚¹ç±»å‹

Rust æœ‰ä¸¤ç§æµ®ç‚¹ç±»å‹ï¼š`f32` å’Œ `f64`ã€‚

```rust
fn main() {
    // f32ï¼šå•ç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ32 ä½ï¼‰
    let x: f32 = 3.14;
    
    // f64ï¼šåŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ64 ä½ï¼Œé»˜è®¤ï¼‰
    let y = 3.14;  // é»˜è®¤ f64
    let z: f64 = 2.71828;
    
    // ç§‘å­¦è®¡æ•°æ³•
    let scientific = 1.0e6;      // 1000000.0
    let negative_exp = 1.0e-6;   // 0.000001
    
    // ç‰¹æ®Šå€¼
    let inf = f64::INFINITY;
    let neg_inf = f64::NEG_INFINITY;
    let nan = f64::NAN;
    
    // æµ®ç‚¹æ•°è¿ç®—
    let sum = 0.1 + 0.2;
    println!("0.1 + 0.2 = {}", sum);  // æ³¨æ„æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜
    
    // æ¯”è¾ƒæµ®ç‚¹æ•°ï¼ˆæ³¨æ„ NaNï¼‰
    if sum > 0.3 {
        println!("å¤§äº 0.3");
    }
    
    // ä½¿ç”¨ approx åº“è¿›è¡Œè¿‘ä¼¼æ¯”è¾ƒï¼ˆéœ€è¦æ·»åŠ ä¾èµ–ï¼‰
    // use approx::assert_relative_eq;
    // assert_relative_eq!(sum, 0.3, epsilon = 0.0001);
}
```

### å¸ƒå°”ç±»å‹

å¸ƒå°”ç±»å‹æœ‰ä¸¤ä¸ªå€¼ï¼š`true` å’Œ `false`ã€‚

```rust
fn main() {
    let t = true;
    let f: bool = false;
    
    // å¸ƒå°”å€¼ç”¨äºæ¡ä»¶è¡¨è¾¾å¼
    if t {
        println!("è¿™æ˜¯çœŸçš„");
    }
    
    // å¸ƒå°”è¿ç®—
    let and = true && false;  // false
    let or = true || false;   // true
    let not = !true;          // false
    
    // æ¯”è¾ƒè¿ç®—è¿”å›å¸ƒå°”å€¼
    let is_equal = 5 == 5;    // true
    let is_greater = 5 > 3;   // true
}
```

### å­—ç¬¦ç±»å‹

`char` ç±»å‹æ˜¯ 4 å­—èŠ‚ Unicode æ ‡é‡å€¼ã€‚

```rust
fn main() {
    // å­—ç¬¦ä½¿ç”¨å•å¼•å·
    let c = 'z';
    let z = 'â„¤';
    let heart = 'â¤';
    let emoji = 'ğŸ˜€';
    
    // æ³¨æ„ï¼šchar å’Œå­—ç¬¦ä¸²ä¸åŒ
    let character = 'a';        // char ç±»å‹
    let string = "a";            // &str ç±»å‹ï¼ˆå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼‰
    let string_literal = "hello"; // &str ç±»å‹
    
    // å­—ç¬¦å¯ä»¥è½¬æ¢ä¸ºæ•°å­—
    let char_to_u32 = 'A' as u32;  // 65
    println!("'A' as u32: {}", char_to_u32);
    
    // Unicode è½¬ä¹‰
    let unicode_char = '\u{1F600}';  // ğŸ˜€
    println!("Unicode å­—ç¬¦: {}", unicode_char);
}
```

### ä¸å…¶ä»–è¯­è¨€å¯¹æ¯”

| è¯­è¨€ | æ•´æ•°é»˜è®¤ | æµ®ç‚¹é»˜è®¤ | å­—ç¬¦ç±»å‹ |
|------|---------|---------|---------|
| **Rust** | `i32` | `f64` | `char` (4å­—èŠ‚ Unicode) |
| **C++** | `int` (å¹³å°ç›¸å…³) | `double` | `char` (1å­—èŠ‚) |
| **Go** | `int` (å¹³å°ç›¸å…³) | `float64` | `rune` (4å­—èŠ‚ Unicode) |
| **Java** | `int` | `double` | `char` (2å­—èŠ‚ UTF-16) |
| **Python** | ä»»æ„ç²¾åº¦ | `float` | `str` (Unicode å­—ç¬¦ä¸²) |

## å¤åˆç±»å‹ï¼ˆCompound Typesï¼‰

å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rust æœ‰ä¸¤ç§åŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„å’Œæ•°ç»„ã€‚

### å…ƒç»„ï¼ˆTupleï¼‰

å…ƒç»„æ˜¯å°†å¤šä¸ªä¸åŒç±»å‹çš„å€¼ç»„åˆæˆä¸€ä¸ªå¤åˆç±»å‹çš„æ–¹å¼ã€‚

```rust
fn main() {
    // åˆ›å»ºå…ƒç»„
    let tup: (i32, f64, u8) = (500, 6.4, 1);
    
    // è§£æ„å…ƒç»„
    let (x, y, z) = tup;
    println!("x: {}, y: {}, z: {}", x, y, z);
    
    // é€šè¿‡ç´¢å¼•è®¿é—®
    println!("ç¬¬ä¸€ä¸ªå…ƒç´ : {}", tup.0);
    println!("ç¬¬äºŒä¸ªå…ƒç´ : {}", tup.1);
    println!("ç¬¬ä¸‰ä¸ªå…ƒç´ : {}", tup.2);
    
    // å…ƒç»„ä½œä¸ºå‡½æ•°è¿”å›å€¼
    let (min, max) = min_max(10, 5);
    println!("min: {}, max: {}", min, max);
    
    // åµŒå¥—å…ƒç»„
    let nested = ((1, 2), (3, 4));
    println!("åµŒå¥—å…ƒç»„: {:?}", nested);
    
    // ç©ºå…ƒç»„ï¼ˆå•å…ƒç±»å‹ï¼‰
    let unit = ();
    println!("å•å…ƒç±»å‹: {:?}", unit);
}

fn min_max(a: i32, b: i32) -> (i32, i32) {
    if a < b {
        (a, b)
    } else {
        (b, a)
    }
}
```

### æ•°ç»„ï¼ˆArrayï¼‰

æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„ç›¸åŒç±»å‹å…ƒç´ çš„é›†åˆã€‚

```rust
fn main() {
    // åˆ›å»ºæ•°ç»„
    let a = [1, 2, 3, 4, 5];
    
    // ç±»å‹æ³¨è§£
    let a: [i32; 5] = [1, 2, 3, 4, 5];
    
    // åˆå§‹åŒ–ç›¸åŒå€¼
    let a = [3; 5];  // [3, 3, 3, 3, 3]
    
    // è®¿é—®å…ƒç´ 
    let first = a[0];
    let second = a[1];
    println!("ç¬¬ä¸€ä¸ªå…ƒç´ : {}, ç¬¬äºŒä¸ªå…ƒç´ : {}", first, second);
    
    // æ•°ç»„é•¿åº¦
    println!("æ•°ç»„é•¿åº¦: {}", a.len());
    
    // éå†æ•°ç»„
    for element in a.iter() {
        println!("å…ƒç´ : {}", element);
    }
    
    // æ•°ç»„è¶Šç•Œä¼šåœ¨è¿è¡Œæ—¶ panic
    // let invalid = a[10];  // è¿è¡Œæ—¶é”™è¯¯ï¼
    
    // å®‰å…¨è®¿é—®ï¼ˆä½¿ç”¨ get æ–¹æ³•ï¼‰
    match a.get(10) {
        Some(value) => println!("å€¼: {}", value),
        None => println!("ç´¢å¼•è¶Šç•Œ"),
    }
}
```

### æ•°ç»„ vs å‘é‡ï¼ˆVectorï¼‰

```rust
fn main() {
    // æ•°ç»„ï¼šå›ºå®šé•¿åº¦ï¼Œæ ˆä¸Šåˆ†é…
    let arr: [i32; 5] = [1, 2, 3, 4, 5];
    
    // å‘é‡ï¼šåŠ¨æ€é•¿åº¦ï¼Œå †ä¸Šåˆ†é…
    let vec = vec![1, 2, 3, 4, 5];
    let mut vec2 = Vec::new();
    vec2.push(1);
    vec2.push(2);
    
    // æ•°ç»„è½¬æ¢ä¸ºå‘é‡
    let vec_from_arr: Vec<i32> = arr.to_vec();
    
    // å‘é‡è½¬æ¢ä¸ºæ•°ç»„ï¼ˆéœ€è¦é•¿åº¦åŒ¹é…ï¼‰
    let arr_from_vec: [i32; 5] = [vec[0], vec[1], vec[2], vec[3], vec[4]];
}
```

### åˆ‡ç‰‡ï¼ˆSliceï¼‰

åˆ‡ç‰‡æ˜¯å¯¹æ•°ç»„æˆ–å‘é‡ä¸€éƒ¨åˆ†çš„å¼•ç”¨ã€‚

```rust
fn main() {
    let arr = [1, 2, 3, 4, 5];
    
    // åˆ›å»ºåˆ‡ç‰‡
    let slice = &arr[1..4];  // [2, 3, 4]
    println!("åˆ‡ç‰‡: {:?}", slice);
    
    // å­—ç¬¦ä¸²åˆ‡ç‰‡
    let s = String::from("hello world");
    let hello = &s[0..5];    // "hello"
    let world = &s[6..11];   // "world"
    
    // å®Œæ•´åˆ‡ç‰‡
    let full_slice = &arr[..];
    
    // ä»å¼€å§‹åˆ°ç´¢å¼•
    let start_slice = &arr[..3];
    
    // ä»ç´¢å¼•åˆ°ç»“æŸ
    let end_slice = &arr[2..];
}
```

## å­—ç¬¦ä¸²ç±»å‹

Rust æœ‰ä¸¤ç§ä¸»è¦çš„å­—ç¬¦ä¸²ç±»å‹ï¼š`String` å’Œ `&str`ã€‚

```rust
fn main() {
    // &strï¼šå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œä¸å¯å˜ï¼Œé€šå¸¸æŒ‡å‘å­—ç¬¦ä¸²å­—é¢é‡
    let s1 = "hello";  // &str ç±»å‹
    let s2: &str = "world";
    
    // Stringï¼šå¯å˜çš„å­—ç¬¦ä¸²ï¼Œåœ¨å †ä¸Šåˆ†é…
    let mut s3 = String::from("hello");
    s3.push_str(" world");
    s3.push('!');
    println!("{}", s3);  // "hello world!"
    
    // å­—ç¬¦ä¸²å­—é¢é‡è½¬ String
    let s4 = "hello".to_string();
    let s5 = String::from("hello");
    
    // String è½¬ &strï¼ˆä¸éœ€è¦æ‰€æœ‰æƒï¼‰
    let s6: &str = &s3;
    
    // å­—ç¬¦ä¸²æ‹¼æ¥
    let s7 = String::from("Hello");
    let s8 = String::from(" World");
    let s9 = s7 + &s8;  // æ³¨æ„ï¼šs7 è¢«ç§»åŠ¨ï¼Œä¸èƒ½å†ä½¿ç”¨
    // println!("{}", s7);  // é”™è¯¯ï¼s7 å·²è¢«ç§»åŠ¨
    
    // ä½¿ç”¨ format! å®ï¼ˆæ¨èï¼‰
    let s10 = format!("{}{}", s8, "!");
    println!("{}", s10);
    
    // å­—ç¬¦ä¸²ç´¢å¼•ï¼ˆRust ä¸æ”¯æŒç›´æ¥ç´¢å¼•ï¼Œå› ä¸º UTF-8ï¼‰
    let s = "hello";
    // let c = s[0];  // é”™è¯¯ï¼ä¸èƒ½ç›´æ¥ç´¢å¼•
    
    // ä½¿ç”¨ chars() è¿­ä»£å­—ç¬¦
    for c in s.chars() {
        println!("{}", c);
    }
    
    // ä½¿ç”¨ bytes() è¿­ä»£å­—èŠ‚
    for b in s.bytes() {
        println!("{}", b);
    }
}
```

## ç±»å‹è½¬æ¢

### æ˜¾å¼ç±»å‹è½¬æ¢

```rust
fn main() {
    // as å…³é”®å­—è¿›è¡Œç±»å‹è½¬æ¢
    let x: i32 = 5;
    let y: f64 = x as f64;
    
    let a: u8 = 255;
    let b: u16 = a as u16;
    
    // æµ®ç‚¹æ•°è½¬æ•´æ•°ï¼ˆæˆªæ–­ï¼‰
    let f: f64 = 3.14;
    let i: i32 = f as i32;  // 3
    
    // å­—ç¬¦è½¬æ•´æ•°
    let c = 'A';
    let n: u8 = c as u8;  // 65
}
```

### å­—ç¬¦ä¸²å’Œæ•°å­—è½¬æ¢

```rust
fn main() {
    // å­—ç¬¦ä¸²è½¬æ•°å­—
    let string_number = "42";
    let number: i32 = string_number.parse().unwrap();
    // æˆ–ä½¿ç”¨ç±»å‹æ¨æ–­
    let number: i32 = string_number.parse().expect("ä¸æ˜¯æ•°å­—");
    
    // æ›´å®‰å…¨çš„è½¬æ¢
    match "42".parse::<i32>() {
        Ok(n) => println!("æ•°å­—: {}", n),
        Err(e) => println!("é”™è¯¯: {}", e),
    }
    
    // æ•°å­—è½¬å­—ç¬¦ä¸²
    let num = 42;
    let string = num.to_string();
    let formatted = format!("æ•°å­—: {}", num);
    
    // æ ¼å¼åŒ–æ•°å­—
    let pi = 3.14159;
    let formatted_pi = format!("{:.2}", pi);  // "3.14"
    println!("{}", formatted_pi);
}
```

## ç±»å‹åˆ«å

å¯ä»¥ä½¿ç”¨ `type` å…³é”®å­—åˆ›å»ºç±»å‹åˆ«åã€‚

```rust
type Kilometers = i32;
type Meters = i32;

fn main() {
    let distance: Kilometers = 5;
    let length: Meters = 1000;
    
    // ç±»å‹åˆ«åä¸»è¦ç”¨äºç®€åŒ–å¤æ‚ç±»å‹
    type Thunk = Box<dyn Fn() + Send + 'static>;
    
    let f: Thunk = Box::new(|| println!("Hello"));
    f();
}
```

## å®è·µç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç±»å‹è½¬æ¢å·¥å…·

```rust
fn main() {
    // æ¸©åº¦è½¬æ¢
    let celsius: f64 = 25.0;
    let fahrenheit = celsius_to_fahrenheit(celsius);
    println!("{}Â°C = {}Â°F", celsius, fahrenheit);
    
    // å•ä½è½¬æ¢
    let kilometers: f64 = 10.0;
    let miles = kilometers_to_miles(kilometers);
    println!("{} km = {:.2} miles", kilometers, miles);
}

fn celsius_to_fahrenheit(c: f64) -> f64 {
    c * 9.0 / 5.0 + 32.0
}

fn kilometers_to_miles(km: f64) -> f64 {
    km * 0.621371
}
```

### ç¤ºä¾‹ 2ï¼šæ•°ç»„æ“ä½œ

```rust
fn main() {
    let numbers = [1, 2, 3, 4, 5];
    
    // è®¡ç®—æ•°ç»„å…ƒç´ å’Œ
    let sum: i32 = numbers.iter().sum();
    println!("å’Œ: {}", sum);
    
    // æŸ¥æ‰¾æœ€å¤§å€¼å’Œæœ€å°å€¼
    let max = numbers.iter().max().unwrap();
    let min = numbers.iter().min().unwrap();
    println!("æœ€å¤§å€¼: {}, æœ€å°å€¼: {}", max, min);
    
    // æ•°ç»„æ˜ å°„
    let doubled: Vec<i32> = numbers.iter().map(|x| x * 2).collect();
    println!("ç¿»å€: {:?}", doubled);
}
```

### ç¤ºä¾‹ 3ï¼šå­—ç¬¦ä¸²å¤„ç†

```rust
fn main() {
    let text = "  Hello, World!  ";
    
    // å»é™¤ç©ºç™½
    let trimmed = text.trim();
    println!("å»é™¤ç©ºç™½: '{}'", trimmed);
    
    // è½¬å¤§å†™
    let uppercase = text.to_uppercase();
    println!("å¤§å†™: {}", uppercase);
    
    // åˆ†å‰²å­—ç¬¦ä¸²
    let words: Vec<&str> = "hello world rust".split_whitespace().collect();
    println!("å•è¯: {:?}", words);
    
    // å­—ç¬¦ä¸²æ›¿æ¢
    let replaced = text.replace("World", "Rust");
    println!("æ›¿æ¢: {}", replaced);
}
```

## æ€»ç»“

- **æ ‡é‡ç±»å‹**ï¼šæ•´æ•°ï¼ˆæœ‰ç¬¦å·/æ— ç¬¦å·ï¼‰ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼ã€å­—ç¬¦
- **å¤åˆç±»å‹**ï¼šå…ƒç»„ï¼ˆä¸åŒç±»å‹ï¼‰ã€æ•°ç»„ï¼ˆç›¸åŒç±»å‹ï¼Œå›ºå®šé•¿åº¦ï¼‰
- **å­—ç¬¦ä¸²**ï¼š`&str`ï¼ˆä¸å¯å˜åˆ‡ç‰‡ï¼‰å’Œ `String`ï¼ˆå¯å˜ï¼Œå †åˆ†é…ï¼‰
- **ç±»å‹è½¬æ¢**ï¼šä½¿ç”¨ `as` å…³é”®å­—æˆ– `parse()` æ–¹æ³•
- **ç±»å‹åˆ«å**ï¼šä½¿ç”¨ `type` å…³é”®å­—ç®€åŒ–å¤æ‚ç±»å‹

ç»§ç»­å­¦ä¹ ï¼š[æ§åˆ¶ç»“æ„](./04-æ§åˆ¶ç»“æ„.md) å­¦ä¹ æ¡ä»¶è¯­å¥å’Œå¾ªç¯ï¼

