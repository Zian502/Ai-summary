# 文件操作

Python 提供了丰富的文件操作功能。

## 文件读写

### 打开文件

```python
# 基本语法：open(file, mode='r', encoding=None)
# mode: 'r'（读）, 'w'（写）, 'a'（追加）, 'x'（创建）, 'b'（二进制）, 't'（文本）

# 读取文件
with open('file.txt', 'r', encoding='utf-8') as f:
    content = f.read()

# 写入文件
with open('file.txt', 'w', encoding='utf-8') as f:
    f.write("Hello, World!")

# 追加文件
with open('file.txt', 'a', encoding='utf-8') as f:
    f.write("\n新内容")
```

### 文件读取方法

```python
# read()：读取整个文件
with open('file.txt', 'r') as f:
    content = f.read()

# readline()：读取一行
with open('file.txt', 'r') as f:
    line = f.readline()

# readlines()：读取所有行（返回列表）
with open('file.txt', 'r') as f:
    lines = f.readlines()

# 逐行迭代（推荐，内存友好）
with open('file.txt', 'r') as f:
    for line in f:
        print(line.strip())
```

### 文件写入方法

```python
# write()：写入字符串
with open('file.txt', 'w') as f:
    f.write("Hello\n")
    f.write("World\n")

# writelines()：写入多行（列表）
lines = ["Line 1\n", "Line 2\n", "Line 3\n"]
with open('file.txt', 'w') as f:
    f.writelines(lines)
```

## 路径操作（pathlib）

```python
from pathlib import Path

# 创建 Path 对象
p = Path('file.txt')
p = Path('/path/to/file.txt')
p = Path.home() / 'Documents' / 'file.txt'

# 路径操作
p.exists()          # 检查是否存在
p.is_file()         # 是否为文件
p.is_dir()          # 是否为目录
p.name              # 文件名
p.stem              # 文件名（不含扩展名）
p.suffix            # 扩展名
p.parent            # 父目录
p.absolute()        # 绝对路径

# 文件操作
p.read_text()       # 读取文本
p.write_text("content")  # 写入文本
p.read_bytes()      # 读取二进制
p.write_bytes(b"content")  # 写入二进制
```

## 实际应用场景 Demo

### Demo 1: 文件复制工具

```python
#!/usr/bin/env python3
# file_copy.py - 文件复制工具

from pathlib import Path
import shutil

def copy_file(source, destination):
    """
    复制文件
    
    参数:
        source: 源文件路径
        destination: 目标文件路径
    """
    source_path = Path(source)
    dest_path = Path(destination)
    
    if not source_path.exists():
        raise FileNotFoundError(f"源文件不存在: {source}")
    
    if source_path.is_dir():
        # 复制目录
        shutil.copytree(source_path, dest_path, dirs_exist_ok=True)
    else:
        # 复制文件
        shutil.copy2(source_path, dest_path)
    
    print(f"成功复制: {source} -> {destination}")

def main():
    """主函数"""
    source = input("请输入源文件路径: ")
    destination = input("请输入目标路径: ")
    
    try:
        copy_file(source, destination)
    except Exception as e:
        print(f"错误: {e}")

if __name__ == "__main__":
    main()
```

### Demo 2: 日志记录工具

```python
#!/usr/bin/env python3
# logger.py - 日志记录工具

from datetime import datetime
from pathlib import Path

class Logger:
    """简单的日志记录器"""
    
    def __init__(self, log_file='app.log'):
        self.log_file = Path(log_file)
        self.log_file.parent.mkdir(parents=True, exist_ok=True)
    
    def log(self, level, message):
        """记录日志"""
        timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        log_entry = f"[{timestamp}] [{level}] {message}\n"
        
        with open(self.log_file, 'a', encoding='utf-8') as f:
            f.write(log_entry)
    
    def info(self, message):
        """信息日志"""
        self.log('INFO', message)
    
    def error(self, message):
        """错误日志"""
        self.log('ERROR', message)
    
    def warning(self, message):
        """警告日志"""
        self.log('WARNING', message)

def main():
    """主函数"""
    logger = Logger('logs/app.log')
    
    logger.info("程序启动")
    logger.warning("这是一个警告")
    logger.error("这是一个错误")
    logger.info("程序结束")

if __name__ == "__main__":
    main()
```

### Demo 3: CSV 文件处理

```python
#!/usr/bin/env python3
# csv_handler.py - CSV 文件处理

import csv
from pathlib import Path

def read_csv(filename):
    """读取 CSV 文件"""
    data = []
    with open(filename, 'r', encoding='utf-8', newline='') as f:
        reader = csv.DictReader(f)
        for row in reader:
            data.append(row)
    return data

def write_csv(filename, data, fieldnames):
    """写入 CSV 文件"""
    with open(filename, 'w', encoding='utf-8', newline='') as f:
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        writer.writeheader()
        writer.writerows(data)

def main():
    """主函数"""
    # 示例数据
    students = [
        {'name': 'Alice', 'age': '25', 'score': '95'},
        {'name': 'Bob', 'age': '30', 'score': '88'},
        {'name': 'Charlie', 'age': '28', 'score': '92'},
    ]
    
    # 写入 CSV
    write_csv('students.csv', students, ['name', 'age', 'score'])
    print("已写入 students.csv")
    
    # 读取 CSV
    data = read_csv('students.csv')
    print("\n读取的数据:")
    for row in data:
        print(row)

if __name__ == "__main__":
    main()
```

## 下一步

完成文件操作学习后，建议学习：
1. [高级特性](./10-高级特性.md) - 生成器、迭代器、上下文管理器
2. [并发编程](./11-并发编程.md) - 多线程、多进程、异步编程

