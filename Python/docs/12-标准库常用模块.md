# 标准库常用模块

Python 标准库提供了丰富的模块，无需安装即可使用。

## collections 模块

### defaultdict

```python
from collections import defaultdict

# 自动创建默认值的字典
dd = defaultdict(int)
dd['a'] += 1  # 不需要先初始化
print(dd['a'])  # 1

# 列表作为默认值
dd_list = defaultdict(list)
dd_list['items'].append(1)
```

### Counter

```python
from collections import Counter

# 计数
text = "hello world"
counter = Counter(text)
print(counter)  # Counter({'l': 3, 'o': 2, 'h': 1, 'e': 1, ' ': 1, 'w': 1, 'r': 1, 'd': 1})
print(counter.most_common(3))  # [('l', 3), ('o', 2), ('h', 1)]
```

### deque

```python
from collections import deque

# 双端队列
dq = deque([1, 2, 3])
dq.appendleft(0)  # 左侧添加
dq.append(4)      # 右侧添加
print(dq)  # deque([0, 1, 2, 3, 4])
```

## itertools 模块

```python
import itertools

# 无限迭代器
counter = itertools.count(start=1, step=2)  # 1, 3, 5, 7, ...
cycle = itertools.cycle(['A', 'B', 'C'])    # A, B, C, A, B, C, ...

# 组合和排列
combinations = list(itertools.combinations([1, 2, 3], 2))  # [(1,2), (1,3), (2,3)]
permutations = list(itertools.permutations([1, 2, 3], 2))  # 所有排列

# 分组
for key, group in itertools.groupby('AAABBBCCAAA'):
    print(key, list(group))
```

## datetime 模块

```python
from datetime import datetime, timedelta

# 当前时间
now = datetime.now()
print(now)

# 格式化
formatted = now.strftime('%Y-%m-%d %H:%M:%S')
print(formatted)

# 时间差
future = now + timedelta(days=7)
print(future)
```

## json 模块

```python
import json

# 序列化
data = {'name': 'Python', 'version': 3.12}
json_str = json.dumps(data)
print(json_str)

# 反序列化
data = json.loads(json_str)
print(data)

# 文件操作
with open('data.json', 'w') as f:
    json.dump(data, f)

with open('data.json', 'r') as f:
    data = json.load(f)
```

## re 模块（正则表达式）

```python
import re

# 匹配
pattern = r'\d+'
text = "我有 3 个苹果和 5 个橙子"
matches = re.findall(pattern, text)
print(matches)  # ['3', '5']

# 替换
result = re.sub(r'\d+', 'X', text)
print(result)  # "我有 X 个苹果和 X 个橙子"
```

## 实际应用场景 Demo

### Demo 1: 使用 collections 进行数据分析

```python
#!/usr/bin/env python3
# data_analysis.py - 数据分析示例

from collections import Counter, defaultdict

def analyze_data(data):
    """分析数据"""
    # 计数
    counter = Counter(data)
    
    # 分组
    grouped = defaultdict(list)
    for item in data:
        grouped[item[0]].append(item[1])
    
    return counter, grouped

data = [('A', 1), ('B', 2), ('A', 3), ('C', 1), ('B', 4)]
counter, grouped = analyze_data(data)
print("计数:", counter)
print("分组:", dict(grouped))
```

## 下一步

完成标准库学习后，建议学习：
1. [第三方库和包管理](./13-第三方库和包管理.md) - pip、虚拟环境
2. [性能优化和调试](./14-性能优化和调试.md) - 性能分析、调试技巧

