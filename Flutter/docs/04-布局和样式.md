# 布局和样式

Flutter 提供了丰富的布局 Widget 来构建响应式和美观的 UI。本章将介绍常用的布局组件和样式装饰。

## 布局 Widget

### SizedBox（固定尺寸）

```dart
// 固定尺寸的空白 Widget（类似于 CSS 的固定宽高 div）
SizedBox(
  width: 100,
  height: 50,
  child: Text('Fixed size'),
)

// 仅用于间距（类似于 CSS margin）
SizedBox(width: 16),  // 水平间距
SizedBox(height: 16), // 垂直间距

// 与 CSS 对比
// CSS: <div style="width: 100px; height: 50px;"></div>
```

### Expanded（扩展）

Expanded 让子 Widget 填充可用空间，类似于 CSS 的 `flex: 1`。

```dart
Row(
  children: [
    Container(width: 50, color: Colors.red),
    Expanded(  // 填充剩余空间
      child: Container(color: Colors.blue),
    ),
    Container(width: 50, color: Colors.green),
  ],
)

// 使用 flex 比例
Row(
  children: [
    Expanded(
      flex: 2,  // 占用 2 份空间
      child: Container(color: Colors.red),
    ),
    Expanded(
      flex: 1,  // 占用 1 份空间
      child: Container(color: Colors.blue),
    ),
  ],
)

// 与 CSS 对比
// CSS: .item { flex: 1; } 或 .item { flex: 2; }
```

### Flexible（灵活）

Flexible 类似于 Expanded，但允许子 Widget 不填充所有空间。

```dart
Row(
  children: [
    Flexible(  // 可以小于可用空间
      child: Container(
        width: 50,  // 实际宽度可能小于可用空间
        color: Colors.blue,
      ),
    ),
    Expanded(  // 必须填充可用空间
      child: Container(color: Colors.red),
    ),
  ],
)
```

### Spacer（间距）

Spacer 在 Flex 布局中创建间距，类似于 CSS 的 `margin: auto`。

```dart
Row(
  children: [
    Text('Left'),
    Spacer(),  // 自动填充间距
    Text('Right'),
  ],
)

// 使用 flex 参数
Row(
  children: [
    Text('Left'),
    Spacer(flex: 2),  // 占用 2 倍间距
    Text('Right'),
  ],
)
```

### Padding（内边距）

```dart
// Padding Widget（类似于 CSS padding）
Padding(
  padding: EdgeInsets.all(16),  // 所有方向
  child: Text('Padded text'),
)

// 不同方向的内边距
Padding(
  padding: EdgeInsets.symmetric(
    horizontal: 16,  // 左右
    vertical: 8,     // 上下
  ),
  child: Text('Text'),
)

Padding(
  padding: EdgeInsets.only(
    left: 16,
    top: 8,
    right: 16,
    bottom: 8,
  ),
  child: Text('Text'),
)

// EdgeInsets 快捷方式
EdgeInsets.all(16)           // 所有方向 16
EdgeInsets.symmetric(horizontal: 16, vertical: 8)  // 对称
EdgeInsets.only(left: 16, top: 8)  // 指定方向
EdgeInsets.fromLTRB(16, 8, 16, 8)  // 左、上、右、下

// 与 CSS 对比
// CSS: padding: 16px; 或 padding: 8px 16px;
```

### Center（居中）

```dart
// 居中 Widget（类似于 CSS: display: flex; justify-content: center; align-items: center;）
Center(
  child: Text('Centered'),
)

// 指定宽高并居中
Center(
  child: Container(
    width: 200,
    height: 200,
    color: Colors.blue,
  ),
)
```

### Align（对齐）

```dart
// 对齐 Widget（类似于 CSS position: absolute + top/right/bottom/left）
Align(
  alignment: Alignment.topRight,  // 右上角
  child: Text('Top Right'),
)

// 自定义对齐
Align(
  alignment: Alignment(0.5, -0.5),  // x: 0.5 (右), y: -0.5 (上)
  child: Text('Custom'),
)

// 常用对齐
Alignment.topLeft
Alignment.topCenter
Alignment.topRight
Alignment.centerLeft
Alignment.center
Alignment.centerRight
Alignment.bottomLeft
Alignment.bottomCenter
Alignment.bottomRight
```

### Wrap（换行）

Wrap 类似于 Row/Column，但会自动换行，类似于 CSS 的 `flex-wrap: wrap`。

```dart
Wrap(
  spacing: 8,        // 水平间距
  runSpacing: 8,     // 垂直间距
  alignment: WrapAlignment.start,
  children: [
    Chip(label: Text('Tag 1')),
    Chip(label: Text('Tag 2')),
    Chip(label: Text('Tag 3')),
    Chip(label: Text('Tag 4')),
    Chip(label: Text('Tag 5')),
  ],
)

// 与 CSS 对比
// CSS: display: flex; flex-wrap: wrap; gap: 8px;
```

### AspectRatio（宽高比）

```dart
// 保持宽高比（类似于 CSS aspect-ratio）
AspectRatio(
  aspectRatio: 16 / 9,  // 16:9 比例
  child: Container(
    color: Colors.blue,
  ),
)

// 与 CSS 对比
// CSS: aspect-ratio: 16 / 9;
```

### ConstrainedBox（约束）

```dart
// 添加尺寸约束（类似于 CSS min-width, max-width）
ConstrainedBox(
  constraints: BoxConstraints(
    minWidth: 100,
    maxWidth: 300,
    minHeight: 50,
    maxHeight: 200,
  ),
  child: Container(
    color: Colors.blue,
    child: Text('Constrained'),
  ),
)

// 与 CSS 对比
// CSS: min-width: 100px; max-width: 300px;
```

### SingleChildScrollView（滚动视图）

```dart
// 单子滚动视图（类似于 CSS overflow: auto）
SingleChildScrollView(
  scrollDirection: Axis.vertical,  // 垂直滚动
  // scrollDirection: Axis.horizontal,  // 水平滚动
  child: Column(
    children: [
      // 很多子 Widget...
    ],
  ),
)

// 带滚动控制器
final _scrollController = ScrollController();

SingleChildScrollView(
  controller: _scrollController,
  child: Column(...),
)

// 滚动到指定位置
_scrollController.animateTo(
  500,
  duration: Duration(seconds: 1),
  curve: Curves.easeInOut,
)
```

## 装饰和样式

### BoxDecoration（容器装饰）

```dart
Container(
  decoration: BoxDecoration(
    // 背景颜色
    color: Colors.blue,
    // 或使用渐变
    gradient: LinearGradient(
      colors: [Colors.blue, Colors.purple],
      begin: Alignment.topLeft,
      end: Alignment.bottomRight,
    ),
    
    // 圆角（类似于 CSS border-radius）
    borderRadius: BorderRadius.circular(8),
    // borderRadius: BorderRadius.only(
    //   topLeft: Radius.circular(8),
    //   topRight: Radius.circular(8),
    // ),
    
    // 边框（类似于 CSS border）
    border: Border.all(
      color: Colors.black,
      width: 2,
    ),
    // 或单独设置
    // border: Border(
    //   top: BorderSide(color: Colors.red, width: 2),
    //   bottom: BorderSide(color: Colors.blue, width: 2),
    // ),
    
    // 阴影（类似于 CSS box-shadow）
    boxShadow: [
      BoxShadow(
        color: Colors.grey.withOpacity(0.5),
        spreadRadius: 2,
        blurRadius: 4,
        offset: Offset(0, 2),
      ),
    ],
    
    // 形状
    shape: BoxShape.rectangle,  // 或 BoxShape.circle
  ),
  child: Text('Decorated'),
)

// 与 CSS 对比
// CSS:
//   background: blue;
//   border-radius: 8px;
//   border: 2px solid black;
//   box-shadow: 0 2px 4px rgba(0,0,0,0.5);
```

### TextStyle（文本样式）

```dart
Text(
  'Styled Text',
  style: TextStyle(
    // 字体大小（类似于 CSS font-size）
    fontSize: 24,
    
    // 字体粗细（类似于 CSS font-weight）
    fontWeight: FontWeight.bold,
    // FontWeight.w100 到 FontWeight.w900
    // FontWeight.normal (400)
    // FontWeight.bold (700)
    
    // 字体样式（类似于 CSS font-style）
    fontStyle: FontStyle.italic,
    
    // 颜色（类似于 CSS color）
    color: Colors.blue,
    
    // 背景色
    backgroundColor: Colors.yellow,
    
    // 装饰线（类似于 CSS text-decoration）
    decoration: TextDecoration.underline,
    // TextDecoration.none
    // TextDecoration.underline
    // TextDecoration.overline
    // TextDecoration.lineThrough
    decorationColor: Colors.red,
    decorationStyle: TextDecorationStyle.dashed,
    
    // 字间距（类似于 CSS letter-spacing）
    letterSpacing: 2,
    
    // 行高（类似于 CSS line-height）
    height: 1.5,
    
    // 字体族（类似于 CSS font-family）
    fontFamily: 'Roboto',
  ),
)

// 使用主题文本样式
Text(
  'Text',
  style: Theme.of(context).textTheme.headlineLarge,
)
```

### InputDecoration（输入框装饰）

```dart
TextField(
  decoration: InputDecoration(
    // 标签文本
    labelText: 'Username',
    
    // 提示文本（类似于 HTML placeholder）
    hintText: 'Enter username',
    
    // 前缀图标
    prefixIcon: Icon(Icons.person),
    
    // 后缀图标
    suffixIcon: IconButton(
      icon: Icon(Icons.clear),
      onPressed: () {},
    ),
    
    // 边框样式
    border: OutlineInputBorder(),
    // border: UnderlineInputBorder(),
    // border: InputBorder.none,
    
    // 填充颜色
    filled: true,
    fillColor: Colors.grey[100],
    
    // 错误文本
    errorText: 'Error message',
    
    // 辅助文本
    helperText: 'Helper text',
  ),
)
```

## 响应式布局

### MediaQuery（媒体查询）

```dart
// 获取屏幕尺寸（类似于 CSS @media）
class ResponsiveWidget extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    // 获取屏幕尺寸
    final screenWidth = MediaQuery.of(context).size.width;
    final screenHeight = MediaQuery.of(context).size.height;
    
    // 判断屏幕方向
    final isPortrait = MediaQuery.of(context).orientation == Orientation.portrait;
    
    // 响应式布局
    if (screenWidth > 600) {
      // 平板/桌面布局
      return Row(
        children: [
          Expanded(child: LeftPanel()),
          Expanded(child: RightPanel()),
        ],
      );
    } else {
      // 手机布局
      return Column(
        children: [
          LeftPanel(),
          RightPanel(),
        ],
      );
    }
  }
}

// 与 CSS 对比
// CSS: @media (min-width: 600px) { ... }
```

### LayoutBuilder（布局构建器）

```dart
// 根据父 Widget 尺寸构建布局
LayoutBuilder(
  builder: (context, constraints) {
    if (constraints.maxWidth > 600) {
      return Row(
        children: [
          Expanded(child: LeftPanel()),
          Expanded(child: RightPanel()),
        ],
      );
    } else {
      return Column(
        children: [
          LeftPanel(),
          RightPanel(),
        ],
      );
    }
  },
)
```

## 实际应用示例

### 响应式卡片布局

```dart
class ResponsiveCardGrid extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    
    // 根据屏幕宽度决定列数
    int crossAxisCount = 1;
    if (screenWidth > 1200) {
      crossAxisCount = 4;
    } else if (screenWidth > 800) {
      crossAxisCount = 3;
    } else if (screenWidth > 600) {
      crossAxisCount = 2;
    }
    
    return GridView.builder(
      gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
        crossAxisCount: crossAxisCount,
        crossAxisSpacing: 16,
        mainAxisSpacing: 16,
        childAspectRatio: 0.75,
      ),
      itemCount: 10,
      itemBuilder: (context, index) {
        return Card(
          elevation: 4,
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Expanded(
                child: Container(
                  width: double.infinity,
                  color: Colors.blue,
                ),
              ),
              Padding(
                padding: EdgeInsets.all(16),
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      'Card $index',
                      style: TextStyle(
                        fontSize: 18,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    SizedBox(height: 8),
                    Text('Description'),
                  ],
                ),
              ),
            ],
          ),
        );
      },
    );
  }
}
```

### 表单布局

```dart
class FormLayout extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('Form')),
      body: SingleChildScrollView(
        padding: EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: [
            // 标题
            Text(
              'User Information',
              style: TextStyle(
                fontSize: 24,
                fontWeight: FontWeight.bold,
              ),
            ),
            SizedBox(height: 24),
            
            // 输入框组
            TextField(
              decoration: InputDecoration(
                labelText: 'First Name',
                border: OutlineInputBorder(),
              ),
            ),
            SizedBox(height: 16),
            
            TextField(
              decoration: InputDecoration(
                labelText: 'Last Name',
                border: OutlineInputBorder(),
              ),
            ),
            SizedBox(height: 16),
            
            TextField(
              decoration: InputDecoration(
                labelText: 'Email',
                border: OutlineInputBorder(),
              ),
            ),
            SizedBox(height: 24),
            
            // 按钮组
            Row(
              children: [
                Expanded(
                  child: OutlinedButton(
                    onPressed: () {},
                    child: Text('Cancel'),
                  ),
                ),
                SizedBox(width: 16),
                Expanded(
                  child: ElevatedButton(
                    onPressed: () {},
                    child: Text('Submit'),
                  ),
                ),
              ],
            ),
          ],
        ),
      ),
    );
  }
}
```

### 侧边栏布局

```dart
class SidebarLayout extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isDesktop = screenWidth > 800;
    
    if (isDesktop) {
      // 桌面布局：侧边栏 + 内容
      return Row(
        children: [
          // 侧边栏
          Container(
            width: 250,
            color: Colors.grey[200],
            child: ListView(
              children: [
                ListTile(title: Text('Home')),
                ListTile(title: Text('About')),
                ListTile(title: Text('Contact')),
              ],
            ),
          ),
          // 内容区域
          Expanded(
            child: Container(
              padding: EdgeInsets.all(16),
              child: Text('Main Content'),
            ),
          ),
        ],
      );
    } else {
      // 移动布局：使用 Drawer
      return Scaffold(
        drawer: Drawer(
          child: ListView(
            children: [
              ListTile(title: Text('Home')),
              ListTile(title: Text('About')),
              ListTile(title: Text('Contact')),
            ],
          ),
        ),
        body: Container(
          padding: EdgeInsets.all(16),
          child: Text('Main Content'),
        ),
      );
    }
  }
}
```

## 总结

- ✅ 使用 SizedBox、Expanded、Flexible 控制尺寸
- ✅ 使用 Padding、Margin 控制间距
- ✅ 使用 BoxDecoration 装饰容器
- ✅ 使用 TextStyle 装饰文本
- ✅ 使用 MediaQuery 和 LayoutBuilder 实现响应式布局
- ✅ Flutter 布局系统灵活强大，可以构建各种复杂 UI

下一步学习：[状态管理](./05-状态管理.md)

